
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="sun-rongyang.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="sun-rongyang.github.io/theme/pygments/solarized-dark.min.css">
  <link rel="stylesheet" type="text/css" href="sun-rongyang.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="sun-rongyang.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Sun Rongyang's Blog Atom">




    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Sun Rongyang" />
<meta name="description" content="Introduction Although the Mac OS X operating system is similar as Linux, there are still several differences between them. So it is necessarily to switch to a pure Linux at any time you want if you are a developer for Linux. The most convenient way is ssh to a Linux …" />
<meta name="keywords" content="Linux, OSX, Mac, VM">

<meta property="og:site_name" content="Sun Rongyang's Blog"/>
<meta property="og:title" content="Use Virtualbox and CentOS 7 Build a Local Linux Developement Environment on Mac"/>
<meta property="og:description" content="Introduction Although the Mac OS X operating system is similar as Linux, there are still several differences between them. So it is necessarily to switch to a pure Linux at any time you want if you are a developer for Linux. The most convenient way is ssh to a Linux …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="sun-rongyang.github.io/2018/use-virtualbox-and-centos-7-build-a-local-linux-developement-environment-on-mac.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-02-17 18:27:00+08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="sun-rongyang.github.io/author/sun-rongyang.html">
<meta property="article:section" content="Unix/Linux"/>
<meta property="article:tag" content="Linux"/>
<meta property="article:tag" content="OSX"/>
<meta property="article:tag" content="Mac"/>
<meta property="article:tag" content="VM"/>
<meta property="og:image" content="/images/avatar.jpg">

  <title>Sun Rongyang's Blog &ndash; Use Virtualbox and CentOS 7 Build a Local Linux Developement Environment on Mac</title>

</head>
<body>
  <aside>
    <div>
      <a href="sun-rongyang.github.io">
        <img src="/images/avatar.jpg" alt="Sun Rongyang" title="Sun Rongyang">
      </a>
      <h1><a href="sun-rongyang.github.io">Sun Rongyang</a></h1>



      <ul class="social">
        <li><a class="sc-envelope-o" href="mailto:sun-rongyang@outlook.com" target="_blank"><i class="fa fa-envelope-o"></i></a></li>
        <li><a class="sc-github" href="https://github.com/sun-rongyang" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="sun-rongyang.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="sun-rongyang.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="use-virtualbox-and-centos-7-build-a-local-linux-developement-environment-on-mac">Use Virtualbox and CentOS 7 Build a Local Linux Developement Environment on Mac</h1>
    <p>
          Posted on Sat 17 February 2018 in <a href="sun-rongyang.github.io/category/unixlinux.html">Unix/Linux</a>


    </p>
  </header>


  <div>
    <h2>Introduction</h2>
<p>Although the Mac OS X operating system is <em>similar</em> as Linux, there are still several differences between them. So it is necessarily to switch to a pure Linux at any time you want if you are a developer for Linux. The most convenient way is ssh to a Linux server when you have a usable internet connection. But internet is not always usable, for example, you are in a aircraft. If one can virtualise a pure Linux environment at background in your local machine and log in though ssh and use a local file system as shared folder, that is very convenient. In this post, I will show you how to virtualise a Linux environment at background locally and set a local folder as a shared folder for the virtual machine. When you ssh to the virtual machine though a local port, you can use this pure Linux environment as your familiar remote Linux server.</p>
<h2>Install Virtualbox on Mac</h2>
<p>Virtualbox installation on your Mac is very easy. You just need go to the <a href="http://download.virtualbox.org/virtualbox/5.2.6/">download page</a>, download the <a href="http://download.virtualbox.org/virtualbox/5.2.6/VirtualBox-5.2.6-120293-OSX.dmg">dmg file</a> (version 5.2.6, now) and install it.</p>
<h2>Install CentOS 7 in the Virtualbox</h2>
<p>Linux environment installation is still straightforward. I select CentOS 7 as an example, here. You can chose any Linux distribution as you want, like Ubuntu, OpenSUSE and Arch.</p>
<p>First, download CentOS 7 distribution iso file at <a href="https://www.centos.org/download/">official website</a>.</p>
<p>Then open the Virtualbox application and click <code>New</code>:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-1.png"></p>
<p>and type some basic information:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-2.png"></p>
<p>Then set memory size of your virtual machine:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-3.png"></p>
<p>Then create a virtual hard disk to your virtual machine:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-4.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-5.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-6.png">
<code>Dynamically allocated</code> can save hard disk space of your Mac.</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-7.png"></p>
<p>Then mount CentOS 7 installation iso file to the optical drive of your virtual machine:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-8.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-9.png"></p>
<p>Finally, <code>Start</code> the virtual machine and install the CentOS 7 follow the installation guide.</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/install-centos7-in-the-virtualbox-10.png"></p>
<h3>Network configurations for the virtual machine</h3>
<p>After normal installation, the virtual machine can not connect to the Internet, because the network device is not turned on when you boot for default configuration. We need modify the default configuration:</p>
<div class="highlight"><pre><span></span>    vi /etc/sysconfig/network-scripts/ifcfg-enp0s3
</pre></div>


<p>Modify <code>ONBOOT=no</code> to <code>ONBOOT=yes</code> and reboot.</p>
<h2>Install Virtualbox Guest Additions</h2>
<h3>Download the matched version iso file</h3>
<p>First get the version of your Virtualbox, and go to the <a href="http://download.virtualbox.org/virtualbox/5.2.6/">download page</a>(for 5.2.6) to download matched version Virtualbox guest additions iso file, <code>VBoxGuestAdditions_[version].iso</code> (for 5.2.6: <a href="http://download.virtualbox.org/virtualbox/5.2.6/VBoxGuestAdditions_5.2.6.iso">VBoxGuestAdditions_5.2.6.iso</a>).</p>
<h3>Install required packages on CentOS 7 virtual machine</h3>
<p>Before install Virtualbox guest additions, we need install some development tools which are needed. The following commends need be executed by a root account or a account with <code>sudo</code>.</p>
<div class="highlight"><pre><span></span>    yum update
    yum groupinstall &quot;Development Tools&quot;
    yum install kernel-devel
    yum install epel-release
    yum install dkms
</pre></div>


<h3>Run installation script to install Virtualbox guest additions</h3>
<p>First, we mount the iso file on the optical drive of the virtual machine like when we installed CentOS 7 and reboot. Then we create a folder to mount the optical drive:</p>
<div class="highlight"><pre><span></span>    mkdir /tmp/VBoxLinuxAdditions
    mount /dev/cdrom /tmp/VBoxLinuxAdditions/
</pre></div>


<p>Then we install Virtualbox guest additions:</p>
<div class="highlight"><pre><span></span>    cd /tmp/VBoxLinuxAdditions
    sh /tmp/VBoxLinuxAdditions/VBoxLinuxAdditions.run
</pre></div>


<p>Finally, we reboot the virtual machine:</p>
<div class="highlight"><pre><span></span>    shutdown -r now
</pre></div>


<h2>Set SSH Login through Localhost</h2>
<h3>In Virtualbox application</h3>
<p>First, we need shut down the virtual machine. Then we set ssh login port:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-ssh-login-through-localhost-1.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-ssh-login-through-localhost-2.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-ssh-login-through-localhost-3.png"></p>
<h3>Start up the virtual machine through command line</h3>
<p>You can start up and manage your virtual machine through command line. We can list all the virtual machines on the host machine:</p>
<div class="highlight"><pre><span></span>    VBoxManage list vms

    ...
    <span class="s2">&quot;CentOS7&quot;</span> <span class="o">{</span>055381a3-fa87-4ed9-a2a7-4a426cd42c44<span class="o">}</span>
    ...
</pre></div>


<p>And start up the virtual machine by the command:</p>
<div class="highlight"><pre><span></span>   VBoxManage startvm CentOS7 --type headless

   Waiting <span class="k">for</span> VM <span class="s2">&quot;CentOS7&quot;</span> to power on...
   VM <span class="s2">&quot;CentOS7&quot;</span> has been successfully started.
</pre></div>


<p>where <code>--type headless</code> start up the virtual machine in the background. If you want to use GUI, you can change it as <code>--type gui</code>. Then you can list all the running virtual machines:</p>
<div class="highlight"><pre><span></span>    VBoxManage list runningvms

    <span class="s2">&quot;CentOS7&quot;</span> <span class="o">{</span>055381a3-fa87-4ed9-a2a7-4a426cd42c44<span class="o">}</span>
</pre></div>


<p>And you can shut down the running virtual machine:</p>
<div class="highlight"><pre><span></span>    VBoxManage controlvm CentOS7 poweroff
</pre></div>


<h3>Connect your virtual machine through command line</h3>
<p>After started up your virtual machine using <code>--type headless</code>, you can connect to your virtual machine through command line as connecting to a remote Linux server:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-ssh-login-through-localhost-4.png"></p>
<h2>Set Shared Folder for the Virtual Machine</h2>
<h3>In the Virtualbox application</h3>
<p>Now we shut down the virtual machine and set a folder of host machine as the shared folder:</p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-shared-folder-for-the-virtual-machine-1.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-shared-folder-for-the-virtual-machine-2.png"></p>
<p><img alt="" src="sun-rongyang.github.io/2018/figure/set-shared-folder-for-the-virtual-machine-3.png"></p>
<h3>Share the folder to normal user on the virtual machine</h3>
<p>Now we start up the virtual machine. And we can find the shared folder at <code>/media/sf_[NameOfTheSharedFolder]</code>. But this folder can only be readded/written by root and users in the <code>vboxsf</code> group. We need add normal user to the <code>vboxsf</code> group to use the shared folder:</p>
<div class="highlight"><pre><span></span>    usermod -a -G vboxsf USER
</pre></div>


<p>where <code>USER</code> is the name of user you want to add to <code>vboxsf</code> group. Then reboot the virtual machine.</p>
<h3>Mount the shared folder to a appointed path</h3>
<p>Now we can use the shared folder, but it is convenient to mount the folder automatically to a appointed path during start up. Add the following code to <code>/etc/rc.local</code></p>
<div class="highlight"><pre><span></span>    mount -t vboxsf -o uid=USER_UID,gid=USER_GID NameOfTheSharedFolder /a/appointed/path
</pre></div>


<p><code>USER_UID</code> and <code>USER_GID</code> can be found in <code>/etc/passwd</code> file. Then add <code>-x</code> attribute to the file:</p>
<div class="highlight"><pre><span></span>   chmod +x /etc/rc.d/rc.local
</pre></div>


<p>Finally, reboot the virtual machine. You will find the shared folder with read/write have been mounted at <code>/a/appointed/path</code> .</p>
<p>That's it! A local pure Linux environment with a host machine shared folder has been constructed.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="sun-rongyang.github.io/tag/linux.html">Linux</a>
      <a href="sun-rongyang.github.io/tag/osx.html">OSX</a>
      <a href="sun-rongyang.github.io/tag/mac.html">Mac</a>
      <a href="sun-rongyang.github.io/tag/vm.html">VM</a>
    </p>
  </div>



    <div class="addthis_relatedposts_inline">


</article>

    <footer>
<p>&copy; Sun Rongyang 2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Sun Rongyang's Blog ",
  "url" : "sun-rongyang.github.io",
  "image": "/images/avatar.jpg",
  "description": ""
}
</script>

</body>
</html>